#!/bin/sh

#TEMP=`getopt -o d46tus --long debug,ipv4,ipv6,tcp,udp,sctp -- $@`

#if [ $? != 0 ] ; 
#    then echo "Terminating..." >&2 ; exit 1 ; fi

# Note the quotes around `$TEMP': they are essential!
eval set -- "$TEMP"

echo -n "OPT=" >makefile
while true ; do
        case "$1" in
                --with-debug)
                    echo "With debug info"
                    echo -n " -g -DDEBUG" >>makefile
                    shift
                    ;;
                --with-ipv4)
                    echo "With ipv4 support"
                    echo -n " -DUSEIP4" >>makefile
                    shift
                    ;;
                --with-ipv6)
                    echo "With ipv6 support"
                    echo -n " -DUSEIP6" >>makefile
                    shift
                    ;;
                --with-tcp)
                    echo "With tcp support"
                    echo -n " -DUSETCP" >>makefile
                    shift
                    ;;
                --with-udp)
                    echo "With udp support"
                    echo -n " -DUSEUDP" >>makefile
                    shift
                    ;;
                --with-sctp)
                    echo "With sctp support"
                    echo -n " -DUSESCTP" >>makefile
                    shift
                    ;;
                --)
                    break
                    ;;
                *)
                    ;;
        esac
done

echo "" >>makefile
cat makefile.def >>makefile
